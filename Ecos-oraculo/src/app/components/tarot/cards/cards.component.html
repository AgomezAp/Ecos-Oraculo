<!DOCTYPE html>
<html lang="en">
  <head>


    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
   <div class="background">
      <button class="back-home-btn" (click)="volverAlInicio()">
        <i class="fa fa-arrow-left"></i> Volver al inicio
      </button>
      <!-- Video de fondo -->
      <video autoplay muted loop playsinline class="background-video">
        <source src="/TAROT.webm" type="video/webm" />
        Tu navegador no soporta videos HTML5.
      </video>

      <h2>Selecciona 3 cartas</h2>
      <div [@fadeIn] class="content-container">
        <div class="cartas-container">
          <div id="cardContainer" class="card-container"></div>
        </div>
      </div>
    </div>

    <div *ngIf="showPaymentModal" class="payment-modal-overlay">
      <div class="payment-modal-content">
        <p class="modal-text">
          Para revelar las descripciones detalladas de tus cartas y lo que los
          astros tienen para ti, por favor realiza una pequeña contribución.
        </p>

        <!-- Stripe Payment Element Container -->
        <div id="payment-element-container"></div>

        <div
          *ngIf="isProcessingPayment && !paymentError"
          class="loading-container"
        >
          <p>
            {{ clientSecret ? "Procesando pago..." : "Inicializando pago..." }}
          </p>
          <div class="spinner"></div>
        </div>

        <div *ngIf="paymentError" class="payment-error-message">
          <p>Error: {{ paymentError }}</p>
        </div>

        <div
          class="modal-actions"
          *ngIf="clientSecret && !isProcessingPayment && !paymentError"
        >
          <button
            (click)="handlePaymentSubmit()"
            class="pay-button"
            [disabled]="isProcessingPayment"
          >
            {{ isProcessingPayment ? "Procesando..." : "Pagar Ahora" }}
          </button>
        </div>
        <button
          (click)="cancelPayment()"
          class="cancel-button"
          [disabled]="isProcessingPayment"
        >
          Cancelar
        </button>
      </div>
    </div>
    <app-recolecta-datos
      *ngIf="showDataModal"
      (onDataSubmitted)="onUserDataSubmitted($event)"
      (onModalClosed)="onDataModalClosed()"
    >
    </app-recolecta-datos>
  </body>
</html>
